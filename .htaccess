# Prevent directory listing
Options -Indexes

# Block access to specific sensitive files
<FilesMatch "^(users\.db|\.env|composer\.lock|package-lock\.json)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>

# Block access to .git directory via RewriteRule (if mod_rewrite is enabled)
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteRule (^|/)\.git - [F,L]
</IfModule>

# Fallback: RedirectMatch (if mod_alias is enabled)
<IfModule mod_alias.c>
    RedirectMatch 404 ^/\.git
</IfModule>
